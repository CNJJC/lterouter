#!/usr/local/sbin/setkey -f

flush;
spdflush;

#transport+esp:
#add 192.168.204.143 192.168.204.135 esp 0x1234 -m tunnel -E sm4-cbc 0x01020304050607080910111213141516 -A hmac-sm3 0x0102030405060708091011121314151601020304050607080910110213141516;
#add 192.168.204.135 192.168.204.143 esp 0x1234 -m tunnel -E sm4-cbc 0x01020304050607080910111213141516 -A hmac-sm3 0x0102030405060708091011121314151601020304050607080910111213141516;

#spdadd 192.168.204.143 192.168.204.135 any -P out ipsec esp/transport//require;
#spdadd 192.168.204.135 192.168.204.143 any -P in ipsec esp/transport//require;

#transport+ah:
#spdadd 192.168.204.135 192.168.204.143 any -P in ipsec ah/transport//require;  
#spdadd 192.168.204.143 192.168.204.135 any -P out ipsec ah/transport//require;  

#Using AH tunnel:  
# add 192.168.204.135 192.168.204.143 ah 0x100 -m transport -A hmac-sha1 0x0102030405060708090a0b0c0d0e0f1011121314;  
# add 192.168.204.143 192.168.204.135 ah 0x200 -m transport -A hmac-sha1 0x5152535455565758595a5b5c5d5e5f6061626364; 

#tunnel+esp:
#spdadd 192.168.0.0/24 192.168.20.0/24 any -P in ipsec esp/tunnel/192.168.20.9-192.168.20.10/require;  
#spdadd 192.168.20.0/24 192.168.0.0/24 any -P out ipsec esp/tunnel/192.168.20.10-192.168.20.9/require;  
#spdadd 192.168.10.0/24[any] 192.168.9.0/24[any] any -P in ipsec esp/tunnel/10.1.2.90-10.1.2.80/require;  
#spdadd 192.168.9.0/24[any] 192.168.10.0/24[any] any -P out ipsec esp/tunnel/10.1.2.80-10.1.2.90/require;  
# Using ESP tunnel:  
# add 10.1.2.80 10.1.2.90 esp 257 -m tunnel -E 3des-cbc 0x5152535455565758595a5b5c5d5e5f606162636465666768 -A hmac-sha1 0x5152535455565758595a5b5c5d5e5f6061626364;  
# add 10.1.2.90 10.1.2.80 esp 256 -m tunnel -E 3des-cbc 0x0102030405060708090a0b0c0d0e0f101112131415161718 -A hmac-sha1 0x0102030405060708090a0b0c0d0e0f1011121314;

#tunnel+ah:
#spdadd 192.168.10.0/24[any] 192.168.9.0/24[any] any -P in ipsec ah/tunnel/10.1.2.90-10.1.2.80/require;  
#spdadd 192.168.9.0/24[any] 192.168.10.0/24[any] any -P out ipsec ah/tunnel/10.1.2.80-10.1.2.90/require;  
#Using AH tunnel:  
# add 10.1.2.80 10.1.2.90 ah 0x100 -m tunnel -A hmac-sha1 0x0102030405060708090a0b0c0d0e0f1011121314;  
# add 10.1.2.90 10.1.2.80 ah 0x200 -m tunnel -A hmac-sha1 0x5152535455565758595a5b5c5d5e5f6061626364;

spdadd 192.168.2.0/24 10.10.3.0/24 any -P in ipsec esp/tunnel/10.10.3.2-10.10.3.1/require;
spdadd 10.10.3.0/24 192.168.2.0/24 any -P out ipsec esp/tunnel/10.10.3.1-10.10.3.2/require;



